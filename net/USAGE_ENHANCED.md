# 🚀 E2E工具增强版客户端使用指南

## ✨ 新功能特性

### 1. **智能路径管理**
- **固定输入目录**: `test/` - 存放载体文件
- **固定输出目录**: `hide/output/` - 存放隐写文件
- **固定接收目录**: `received_files/` - 存放接收的文件

### 2. **自动补全功能**
- 支持 **Tab键自动补全** 文件名和路径
- 智能识别当前目录下的文件和文件夹
- 支持相对路径和绝对路径

### 3. **智能文件识别**
- 自动识别文件类型（图片、PDF、视频）
- 按类型分类显示可用文件
- 自动生成默认输出文件名

## 🎯 使用方法

### 启动客户端
```bash
source venv/bin/activate
python3 net/websocket_client.py
```

### 可用命令

#### 1. **`files`** - 显示可用文件
```bash
> files
```
**功能**: 显示输入目录中的所有文件，按类型分类

**输出示例**:
```
=== 可用文件 ===
📁 输入目录: /Users/umiri/Projects/e2e_tool/test
📄 所有文件:
  - test_image.png
  - test_document.pdf
  - test.txt

🖼️  image文件:
  - test_image.png

📄 pdf文件:
  - test_document.pdf
```

#### 2. **`sendmsg`** - 发送隐写消息
```bash
> sendmsg
```

**交互流程**:
1. 选择隐写类型: `image` / `pdf` / `video`
2. 系统显示可用文件列表
3. 输入载体文件名（支持Tab补全）
4. 输入输出文件名（留空使用默认名称）
5. 输入要发送的明文消息

**示例**:
```
=== 发送隐写消息 ===
请选择隐写类型（image/pdf/video）: image
📁 可用的image文件: test_image.png
请输入载体文件名（或完整路径）: test_image.png
请输入输出文件名（留空使用默认名称）: my_stego.png
📁 输出路径: /Users/umiri/Projects/e2e_tool/hide/output/my_stego.png
请输入要发送的明文消息: Hello, this is a secret message!
```

#### 3. **`sendfile <文件名> <类型>`** - 发送文件
```bash
> sendfile test.txt text
```

**功能**: 直接发送文件，支持智能路径解析

#### 4. **`extractmsg`** - 提取隐写消息
```bash
> extractmsg
```

**交互流程**:
1. 选择隐写类型
2. 系统显示可用的隐写文件
3. 输入隐写文件名
4. 自动提取并解密消息

#### 5. **普通消息** - 直接输入文本
```bash
> Hello, how are you?
```

## 🎨 智能路径解析

### 输入路径解析
- **只有文件名**: 自动在 `test/` 目录中查找
- **相对路径**: 相对于当前工作目录
- **绝对路径**: 直接使用完整路径

### 输出路径解析
- **留空**: 自动生成带时间戳的默认文件名
- **只有文件名**: 自动保存到 `hide/output/` 目录
- **完整路径**: 直接使用指定路径

### 自动补全使用
```bash
# 输入文件名时按Tab键
请输入载体文件名: test_<Tab>
# 会显示所有以 "test_" 开头的文件
```

## 📁 目录结构

```
e2e_tool/
├── test/                    # 输入文件目录
│   ├── test_image.png      # 载体图片
│   ├── test_document.pdf   # 载体PDF
│   └── test.txt           # 普通文件
├── hide/output/            # 输出文件目录
│   ├── stego_image_xxx.png # 隐写图片
│   └── stego_pdf_xxx.pdf   # 隐写PDF
└── received_files/         # 接收文件目录
    └── received_xxx.png    # 接收的文件
```

## 🔧 高级功能

### 1. **文件类型支持**
- **图片**: PNG, JPG, JPEG, BMP, TIFF
- **PDF**: PDF文档
- **视频**: MP4, AVI, MOV, MKV

### 2. **自动文件管理**
- 自动创建必要的目录
- 自动生成唯一的文件名
- 自动分类文件类型

### 3. **错误处理**
- 文件不存在时显示可用文件列表
- 路径错误时提供智能建议
- 详细的错误信息和堆栈跟踪

## 💡 使用技巧

### 1. **快速发送隐写消息**
```bash
> sendmsg
# 选择 image
# 输入 test_image.png
# 留空输出文件名（使用默认）
# 输入消息
```

### 2. **查看可用文件**
```bash
> files
# 查看所有可用文件
```

### 3. **使用Tab补全**
```bash
# 在输入文件名时按Tab键
# 可以快速选择文件
```

### 4. **批量处理**
```bash
# 可以连续发送多个隐写消息
# 每个消息使用不同的载体文件
```

## 🚨 注意事项

1. **文件路径**: 建议将载体文件放在 `test/` 目录中
2. **文件大小**: 大文件传输可能需要较长时间
3. **网络连接**: 确保WebSocket服务器正在运行
4. **权限问题**: 确保有写入输出目录的权限

## 🎉 总结

增强版客户端提供了：
- ✅ **智能路径管理** - 无需记忆复杂路径
- ✅ **自动补全功能** - 提高输入效率
- ✅ **文件类型识别** - 自动分类显示
- ✅ **错误处理** - 友好的错误提示
- ✅ **用户友好** - 简化的操作流程

现在你可以更轻松地使用E2E工具进行端到端加密通信了！ 